# ğŸš€ CUDA GEMM Optimization Project

æœ¬é¡¹ç›®æ—¨åœ¨å±•ç¤ºå¦‚ä½•é€æ­¥ä¼˜åŒ–çŸ©é˜µä¹˜ï¼ˆGEMMï¼‰åœ¨ GPU ä¸Šçš„æ€§èƒ½ï¼Œæœ€ç»ˆå®ç°å¯¹ NVIDIA Tensor Core çš„é«˜æ•ˆåˆ©ç”¨ã€‚é€‚ç”¨äºå­¦ä¹  CUDA ä¼˜åŒ–ã€æ€§èƒ½å‰–æï¼ˆncu/nsysï¼‰åŠç®€å†å±•ç¤ºã€‚

---

## ğŸ“ é¡¹ç›®ç»“æ„

- `kernels/`ï¼šå­˜æ”¾å„ä¼˜åŒ–é˜¶æ®µçš„ CUDA kernel
- `include/`ï¼šå¤´æ–‡ä»¶ï¼Œå£°æ˜å„ kernel å‡½æ•°
- `main.cu`ï¼šä¸»ç¨‹åºï¼Œè°ƒç”¨ä¸åŒç‰ˆæœ¬å¹¶è¾“å‡ºæ€§èƒ½
- `results/`ï¼šå­˜æ”¾ profiling æŠ¥å‘Šå’Œ benchmark æ•°æ®
- `plots/`ï¼šç»˜å›¾è„šæœ¬å’Œå¯¹æ¯”å›¾
- `Makefile`ï¼šä¸€é”®ç¼–è¯‘è¿è¡Œ

---

## ğŸ§  ä¼˜åŒ–é˜¶æ®µè¯´æ˜

| é˜¶æ®µç¼–å· | ä¼˜åŒ–ç­–ç•¥                          | è¯´æ˜                                                                 |
|----------|----------------------------------|----------------------------------------------------------------------|
| Stage 0  | Naive GEMM                       | æ¯çº¿ç¨‹è®¡ç®—ä¸€ä¸ªå…ƒç´ ï¼Œæ— å…±äº«å†…å­˜ï¼Œä½æ•ˆå…¨å±€è®¿å­˜                        |
| Stage 1  | Tiled GEMM                       | åˆ©ç”¨ shared memory è¿›è¡Œ tile å…±äº«ï¼Œé™ä½ global memory è®¿é—®         |
| Stage 2  | Register Blocking                | æ¯çº¿ç¨‹è®¡ç®— 2x2 å—ï¼Œå‡å°‘è®¿å­˜å’Œ thread æ•°                             |
| Stage 3  | Double Buffering                 | ä½¿ç”¨åŒç¼“å†²éšè— shared memory åŠ è½½å»¶è¿Ÿ                               |
| Stage 4  | Tensor Core (Standard Tile)     | åˆ©ç”¨ WMMAï¼ˆ16x16x16ï¼‰ fragment å®ç°ç¡¬ä»¶çŸ©é˜µä¹˜ï¼Œæå‡åå              |
| Stage 5  | Tensor Core (Large Tile)        | å¤šæ¬¡ä½¿ç”¨ Tensor Core Fragment å¹¶ä¼˜åŒ–å…±äº«å†…å­˜å’Œçº¿ç¨‹ç»‘å®šå¸ƒå±€         |

---

## ğŸš¦ ç¼–è¯‘ä¸è¿è¡Œ

```bash
make
./gemm_test 1024

## ğŸ” åˆ†ææ€§èƒ½
ncuï¼šå•ä¸ª kernel çš„æŒ‡ä»¤çº§åˆ«æ‰§è¡Œã€SM åˆ©ç”¨ç‡ã€Tensor Core åˆ©ç”¨ç‡ã€å†…å­˜ååã€bank conflict ç­‰
which ncu
sudo /usr/local/cuda-12.1/bin/ncu --target-processes all ./gemm_test 4096

nsysï¼šæ•´ä½“ç¨‹åºè°ƒåº¦ã€CPU ä¸ GPU çš„ååŒã€kernel è°ƒåº¦é¡ºåºã€CPU stallã€kernel overlap ç­‰
nsys profile --stats=true --force-overwrite true -o report_nsys ./gemm_test 4096
